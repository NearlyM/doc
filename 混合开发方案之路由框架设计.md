# 混合开发方案之路由框架设计

> 随着项目越来越大，产品类型越来越多，开发人员越来越多，组件化开发日益迫切。原生开发也可以实现组件化，但是在热更新实现上比较困难。目前大前端的趋势，React native的普及以及RN的热更新，使得我们选择了RN和原生一起来开发新的APP基础框架。

本文主要由一下三个章节组成：

1. 方案分析
2. 方案设计
3. 路由协议设计（下一篇独立文章来设计）

## 一、方案分析

针对android和iOS在热更新和界面统一上的问题，我们针对现有的一些方案，简单介绍。

1. 原生开发

   这里列出[sophix](https://help.aliyun.com/document_detail/69874.html?spm=a2c4g.11174283.6.552.KE7jWx	"sophix")，代替了一类android原生热更新的方案，分别针对java代码、图片文字资源以及静态库去动态替换的方案。比较成熟，但是也有较多的限制，这里不展开讲述，想了解的可以去看看相关文档资料。

   > 优点：
   >
   > 1. 可控性大
   >
   > 缺点：
   >
   > 1. 热更新不易
   > 2. 界面差异明显
   > 3. 重复开发
   > 4. 开发需要维护android和ios两套完全代码
   > 5. 模块耦合大
   > 6. 开发编译时间长，不支持热重载

2. react native

   React Native是facebook开源的开发框架，目前存在一些性能上的问题，facebook也在积极去更新。未来应该是一个不错的框架。

   React Native可以去解决一些可热更新去处理的bug，或者热更新Rn模块中的功能。

   经过一个阶段的react native开发，发现在列表使用时会存在刷新列表空白的问题。并且rn开发界面效率更高。

   > 优点：
   >
   > 1. 热更新成熟
   > 2. android和ios公用一套代码，避免重复开发
   > 3. 界面开发更快速
   > 4. 维护成本低
   > 5. 热重载
   >
   > 缺点：
   >
   > 1. 开发时适配工作量大（android和ios差异）
   > 2. 渲染性能稍差

3. flutter

   google开源的移动UI框架，可以快速在iOS和android上构建app。

   > **从长远的角度来看，flutter是更合适的一种方案**
   >
   > 优点：
   >
   > 1. 渲染性能好，直接进行渲染（RN先转为原生，再去渲染）
   > 2. android和ios的适配性好
   > 3. 热重载
   >
   > 但是目前来说，有以下的
   >
   > 缺点：
   >
   > 1. 需要学习成本
   > 2. 热更新方案不确定
   > 3. 三方库支持少



## 二、方案设计

针对上面的方案分析，以及结合现有项目的实际，设计混合开发方案。

对于一个中大型项目来说，参与者会比较多，开发的时候大家相互依赖，会导致项目进度缓慢，效率低下。所以我们参考现有的组件化开发方案来设计本次的基础框架以及模块（可以成为组件）。

方案要求：

1. 基础模块设计：各种工具，基础组件；
2. 各模块相互解耦（除了基础模块）；
3. 各模块单独运行（除了基础模块）；

混合开发方案模块路由图：

![混合开发方案模块路由图](/home/danale/Danale/doc/混合开发方案设计/混合开发方案第二版.png)



混合开发方案模块设计图：

![](/home/danale/Danale/doc/混合开发方案设计/混合开发方案第二版交互图.png)